#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <gsl/gsl_matrix.h>
#include <gsl/gsl_blas.h>
#include <gsl/gsl_math.h>
#include <gsl/gsl_complex.h>
#include <gsl/gsl_complex_math.h>
#include <gsl/gsl_linalg.h>
#include "stabilizer.h"


void testUpdateDJ(){
	printf("\nTest updateDJ:\n");
	struct StabilizerStates state;
	
	state.n = 40;
	state.k = 40;
	double Rdata[] = { 
		1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 
	};
	double Ddata[] = {
		2, 6, 0, 4, 4, 0, 6, 0, 0, 4, 2, 0, 6, 2, 0, 0, 6, 4, 2, 2, 6, 4, 0, 2, 2, 0, 4, 6, 4, 2, 2, 6, 0, 6, 2, 0, 0, 6, 6, 0
	};
	double Jdata[] = {
		4,0,4,4,0,4,0,4,4,4,4,0,0,4,0,0,4,4,4,4,4,0,0,0,4,4,0,0,4,0,4,0,0,4,0,0,0,0,4,0,0,4,0,4,4,0,0,4,4,4,0,0,4,4,4,4,0,0,0,0,0,0,4,0,4,4,0,0,0,4,4,4,4,0,0,4,0,4,0,0,4,0,0,0,4,4,0,0,4,0,0,0,4,0,0,4,0,4,4,4,0,0,4,4,4,0,0,0,4,0,4,0,0,0,0,0,0,4,4,0,4,4,0,0,4,4,4,0,4,4,0,0,0,4,4,0,0,4,0,0,4,4,4,0,0,0,4,4,0,4,4,0,0,4,4,0,4,0,4,0,0,4,4,4,0,4,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,4,4,4,0,0,0,4,4,0,0,0,4,0,4,4,4,0,4,0,0,0,0,0,0,0,4,0,0,4,4,4,4,0,4,0,0,0,0,0,0,4,4,0,0,4,4,4,4,0,0,4,0,0,0,4,4,4,4,4,4,0,4,0,4,4,4,4,0,4,0,4,0,0,4,0,0,4,4,4,0,0,4,0,0,0,4,4,4,4,0,0,4,4,0,0,0,0,4,0,0,4,4,4,4,4,0,0,4,4,0,0,0,0,4,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,4,0,0,4,4,0,4,0,0,0,0,0,4,4,4,4,0,0,4,0,0,0,0,0,0,4,0,4,4,0,4,0,0,4,4,4,0,4,0,0,0,4,4,0,0,4,0,4,0,0,0,4,4,4,0,0,0,4,0,0,0,0,4,4,0,4,0,0,0,4,0,4,4,4,4,0,0,0,0,0,4,4,4,0,4,4,0,0,4,0,0,0,0,0,4,0,0,0,4,0,4,4,4,0,0,0,4,0,4,4,0,4,4,4,0,0,0,0,0,0,0,4,0,4,4,0,4,0,4,0,0,4,4,0,4,4,4,0,4,4,4,4,4,4,0,0,0,0,0,4,0,0,0,4,0,4,4,0,0,0,4,4,4,0,0,4,4,0,4,4,0,4,4,0,0,0,0,4,0,4,0,4,0,0,0,4,0,0,4,4,4,4,0,4,4,4,0,4,4,0,4,4,0,4,0,0,0,4,4,4,0,0,4,0,0,4,0,4,4,0,0,4,0,4,4,0,4,4,0,4,0,4,4,4,0,4,0,4,0,4,4,0,0,0,4,4,4,4,0,0,4,4,4,4,4,0,0,0,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,0,0,4,4,0,0,0,4,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,4,4,0,4,4,4,4,4,4,4,0,0,0,0,4,4,4,0,4,0,0,0,0,0,0,4,0,0,0,0,0,0,4,0,4,4,0,0,4,0,4,0,0,0,4,4,4,0,0,4,4,0,0,0,4,0,0,0,4,0,4,4,0,4,4,4,0,4,0,4,4,0,4,0,4,0,4,0,0,4,0,0,0,4,0,0,0,0,0,4,4,0,4,0,0,0,4,4,4,0,4,0,0,4,0,0,4,4,0,4,4,4,4,0,0,4,4,4,0,4,4,0,4,4,0,0,4,0,4,0,4,4,4,4,0,4,4,0,4,0,4,0,0,4,4,0,4,4,0,0,0,0,4,0,0,0,4,4,4,4,0,0,4,0,0,0,0,0,0,0,0,4,4,0,4,0,0,4,4,0,0,4,0,4,0,0,4,0,4,4,0,0,4,0,4,0,0,4,4,4,4,4,4,0,4,0,4,4,0,4,4,4,4,0,4,4,4,0,0,0,0,4,0,0,0,0,4,0,0,4,0,4,0,0,0,4,4,4,4,0,4,4,4,0,4,4,4,4,4,0,0,0,0,0,0,4,4,0,0,4,4,4,0,4,4,4,0,0,0,4,0,0,0,4,4,0,4,0,4,4,0,0,0,0,0,0,0,4,0,4,0,4,4,4,4,0,4,0,0,0,4,0,4,0,0,0,0,4,0,0,4,4,0,4,0,0,0,0,4,4,0,4,0,0,4,4,4,4,4,4,4,0,4,0,0,4,4,0,4,4,4,0,4,0,0,0,4,0,4,4,0,4,4,0,0,0,4,4,4,4,0,0,4,4,0,4,0,0,0,0,0,4,0,4,4,4,4,0,4,4,0,0,4,0,4,0,0,0,0,4,4,0,4,4,0,4,4,0,0,0,0,0,4,0,4,0,4,4,4,0,4,4,0,0,4,0,4,4,0,0,0,4,0,0,4,0,0,0,4,4,0,0,4,4,4,0,0,0,4,4,0,4,0,4,0,4,4,0,0,0,4,4,4,0,0,4,0,0,0,0,0,4,0,0,4,0,0,0,4,4,4,4,4,4,4,0,0,0,0,4,0,4,4,0,4,4,4,4,4,0,0,0,0,0,4,4,0,4,4,0,4,0,0,0,0,0,0,4,4,4,0,0,4,4,4,0,4,0,4,4,0,4,0,4,4,4,0,4,0,0,4,0,0,0,0,4,0,0,0,4,0,4,4,4,0,4,0,4,0,4,0,4,4,4,0,0,0,0,4,4,4,4,0,4,0,4,4,4,4,4,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,4,4,4,0,0,4,0,0,4,0,4,0,4,0,4,0,4,4,4,0,4,0,0,0,4,0,4,0,4,0,0,4,0,0,4,4,4,0,0,4,0,4,4,4,4,0,0,4,0,4,4,0,0,0,0,0,4,4,4,4,0,4,4,0,0,4,0,0,4,0,0,0,0,0,4,0,0,4,0,0,4,0,0,4,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,0,4,4,4,4,0,4,4,0,0,4,0,4,0,4,4,0,0,0,0,4,0,0,0,0,4,4,4,0,4,0,4,4,4,0,0,0,4,0,0,4,0,4,4,4,0,0,0,0,0,4,0,4,4,4,4,0,4,0,4,0,4,0,0,4,4,4,4,0,4,4,0,0,4,0,0,0,0,4,4,0,4,4,0,4,4,4,0,4,0,0,4,4,4,4,0,4,4,4,4,4,4,0,0,0,4,0,0,0,4,0,4,0,0,0,0,4,0,4,4,4,4,0,4,0,4,4,0,0,0,4,4,4,4,4,4,0,0,0,4,0,4,4,4,0,0,4,4,0,4,0,4,4,0,4,0,4,0,0,4,4,0,4,0,4,4,0,0,4,4,0,0,0,4,4,0,4,4,0,4,4,4,4,0,0,4,0,4,4,0,4,4,0,4,4,4,4,4,0,4,4,4,0,4,4,4,4,4,0,4,4,0,0,0,4,0,4,4,0,0,4,4,4,0,4,4,0,4,4,4,4,4,4,0,0,0,4,0,4,0,0,4,4,4,4,4,4,0,0,0,0,0,4,0,4,4,4,4,4,4,4,0,0,0,4,0,4,0,0,0,0,0,4,0,4,0,4,4,0,4,0,4,4,0,4,4,0
	};
	double outDdata[] = {
		2.0, 6.0, 0.0, 4.0, 2.0, 0.0, 6.0, 0.0, 0.0, 4.0, 2.0, 0.0, 6.0, 2.0, 0.0, 0.0, 6.0, 4.0, 2.0, 2.0, 6.0, 4.0, 0.0, 2.0, 2.0, 0.0, 4.0, 6.0, 4.0, 2.0, 2.0, 6.0, 0.0, 6.0, 2.0, 0.0, 0.0, 6.0, 6.0, 0.0
	};
	double outJdata[] = {
		4,0,4,4,0,4,0,4,4,4,4,0,0,4,0,0,4,4,4,4,4,0,0,0,4,4,0,0,4,0,4,0,0,4,0,0,0,0,4,0,0,4,0,4,4,0,0,4,4,4,0,0,4,4,4,4,0,0,0,0,0,0,4,0,4,4,0,0,0,4,4,4,4,0,0,4,0,4,0,0,4,0,0,0,4,4,0,0,4,0,0,0,4,0,0,4,0,4,4,4,0,0,4,4,4,0,0,0,4,0,4,0,0,0,0,0,0,4,4,0,4,4,0,0,0,4,4,0,4,4,0,0,0,4,4,0,0,4,0,0,4,4,4,0,0,0,4,4,0,4,4,0,0,4,4,0,4,0,4,0,0,4,4,0,4,4,0,0,4,0,4,4,4,0,4,4,4,0,0,0,0,4,0,0,0,4,4,4,4,0,0,4,0,0,0,4,0,4,0,4,4,0,4,4,4,0,4,0,0,0,0,0,0,0,4,0,0,4,4,4,4,0,4,0,0,0,0,0,0,4,4,0,0,4,4,4,4,0,0,4,0,0,0,4,0,4,4,4,4,0,4,0,4,4,4,4,0,4,0,4,0,0,4,0,0,4,4,4,0,0,4,0,0,0,4,4,4,4,0,0,4,4,0,0,0,0,4,0,0,4,4,4,4,4,0,0,4,4,0,0,0,0,4,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,4,0,0,4,4,0,4,0,0,0,0,0,4,4,4,4,0,0,4,0,0,0,0,0,0,4,0,4,4,0,4,0,0,4,4,4,0,4,0,0,0,4,4,0,0,4,0,4,0,0,0,4,4,4,0,0,0,4,0,0,0,0,4,4,0,4,0,0,0,4,0,4,4,4,4,0,0,0,4,0,4,4,4,0,4,4,0,0,4,0,0,0,0,0,4,0,0,0,4,0,4,4,4,0,0,0,4,0,4,4,0,4,4,4,0,0,0,0,4,0,0,4,0,4,4,0,4,0,4,0,0,4,4,0,4,4,4,0,4,4,4,4,4,4,0,0,0,0,0,4,0,0,0,4,0,4,4,0,4,0,4,4,4,0,0,4,4,0,4,4,0,4,4,0,0,0,0,4,0,4,0,4,0,0,0,4,0,0,4,4,4,4,0,4,4,4,0,4,0,0,4,4,0,4,0,0,0,4,4,4,0,0,4,0,0,4,0,4,4,0,0,4,0,4,4,0,4,4,0,4,0,4,4,4,0,4,0,4,4,4,4,0,0,0,4,4,4,4,0,0,4,4,4,4,4,0,0,0,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,0,0,4,4,0,4,0,4,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,4,4,0,4,4,4,4,4,4,4,0,0,0,0,4,4,4,0,4,0,0,0,4,0,0,4,0,0,0,0,0,0,4,0,4,4,0,0,4,0,4,0,0,0,4,4,4,0,0,4,4,0,0,0,4,0,0,0,4,0,4,4,0,4,4,4,0,4,0,4,4,0,4,0,4,0,4,0,0,4,0,0,0,4,0,0,0,0,0,4,4,0,4,0,0,0,4,4,4,0,4,0,0,4,0,0,4,4,0,4,4,4,4,0,0,4,4,4,0,4,4,0,4,4,0,0,4,0,4,0,4,4,4,4,0,4,4,0,4,0,4,0,0,4,4,0,4,4,0,0,0,0,4,0,0,0,4,4,4,4,0,0,4,0,0,0,0,0,0,0,0,4,4,0,4,0,0,4,4,0,0,4,0,4,0,0,4,0,4,4,0,0,4,0,4,0,0,4,4,4,4,4,4,0,4,0,4,4,0,4,4,4,4,0,4,4,4,0,0,0,0,4,4,0,0,0,4,0,0,4,0,4,0,0,0,4,4,4,4,0,4,4,4,0,4,4,4,4,4,0,0,0,0,0,0,4,4,0,0,4,4,4,0,4,4,4,0,0,0,4,0,0,0,4,4,0,4,0,4,4,0,0,0,0,0,0,0,4,0,4,0,4,4,4,4,0,4,0,0,0,4,0,0,0,0,0,0,4,0,0,4,4,0,4,0,0,0,0,4,4,0,4,0,0,4,4,4,4,4,4,4,0,4,0,0,4,4,0,4,4,4,0,0,0,0,0,4,0,4,4,0,4,4,0,0,0,4,4,4,4,0,0,4,4,0,4,0,0,0,0,0,4,0,4,4,4,4,0,4,4,0,0,4,0,4,0,0,0,0,4,4,0,4,4,0,4,4,0,0,0,0,0,4,0,4,0,4,4,4,0,4,4,0,0,4,0,4,4,0,0,0,4,4,0,4,0,0,0,4,4,0,0,4,4,4,0,0,0,4,4,0,4,0,4,0,4,4,0,0,0,4,4,4,0,0,4,0,0,0,0,0,4,4,0,4,0,0,0,4,4,4,4,4,4,4,0,0,0,0,4,0,4,4,0,4,4,4,4,4,0,0,0,0,0,4,4,0,4,4,0,4,0,4,0,0,0,0,4,4,4,0,0,4,4,4,0,4,0,4,4,0,4,0,4,4,4,0,4,0,0,4,0,0,0,0,4,0,0,0,4,0,4,0,4,0,4,0,4,0,4,0,4,4,4,0,0,0,0,4,4,4,4,0,4,0,4,4,4,4,4,0,0,0,4,4,4,4,4,4,4,4,4,0,4,4,4,0,0,0,0,0,4,4,4,0,0,4,0,0,4,0,4,0,4,0,4,0,4,4,4,0,4,0,0,0,4,0,4,0,4,0,0,4,0,0,4,4,4,0,0,4,0,4,4,4,4,0,0,4,0,4,4,0,0,0,0,0,4,4,4,4,0,4,4,0,0,4,0,0,4,0,0,0,0,0,4,0,0,4,0,0,4,0,0,4,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,0,4,4,4,4,0,4,4,0,0,4,0,4,0,4,4,0,0,0,0,4,0,0,0,0,4,4,4,0,4,0,4,4,4,0,0,0,4,0,0,4,0,4,4,4,0,0,0,0,0,4,0,4,4,4,4,0,4,0,4,0,4,0,0,4,4,4,4,0,4,4,0,0,4,0,0,0,0,4,4,0,4,4,0,4,4,4,0,4,0,0,4,4,4,4,0,4,4,4,4,4,4,0,0,0,4,0,0,0,4,0,4,0,0,0,0,4,0,4,4,4,4,0,4,0,4,4,0,0,0,4,0,4,4,4,4,0,0,0,4,0,4,4,4,0,0,4,4,0,4,0,4,4,0,4,0,4,0,0,4,4,0,4,0,4,4,0,0,4,4,0,4,0,4,4,0,4,4,0,4,4,4,4,0,0,4,0,4,4,0,4,4,0,4,4,4,4,4,0,4,4,4,0,4,4,4,4,4,0,4,4,0,0,0,4,0,4,4,0,0,4,4,4,0,4,4,0,4,4,4,4,4,4,0,0,0,4,0,4,0,0,4,4,4,4,4,4,0,0,0,0,4,4,0,4,4,4,4,4,4,4,0,0,0,4,0,4,0,0,0,0,0,4,0,4,0,4,4,0,4,0,4,4,0,4,4,0
	};
	
	gsl_matrix_view RmatrixView = gsl_matrix_view_array(Rdata, state.k, state.k);
	gsl_matrix *R;
	R = &RmatrixView.matrix;
	gsl_vector_view DvectorView = gsl_vector_view_array(Ddata, state.k);
	state.D = &DvectorView.vector;
	gsl_matrix_view JmatrixView = gsl_matrix_view_array(Jdata, state.k, state.k);
	state.J = &JmatrixView.matrix;
	gsl_vector_view outDVectorView = gsl_vector_view_array(outDdata, state.k);
	gsl_vector *outD;
	outD = &outDVectorView.vector;
	gsl_matrix_view outJMatrixView = gsl_matrix_view_array(outJdata, state.k, state.k);
	gsl_matrix *outJ;
	outJ = &outJMatrixView.matrix;
	
	updateDJ(&state, R);
	
	int isDWorking = 1;
	for(int i=0;i<state.k;i++){
		if(gsl_vector_get(state.D, i) != gsl_vector_get(outD, i)){
			isDWorking = 0;
			break;
		}
	}
	printf("D %s\n",isDWorking>0?"works":"fails");
	
	int isJWorking = 1;
	for(int i=0;i<state.k;i++){
		for(int j=0;j<state.k;j++){
			if(gsl_matrix_get(state.J, i, j) != gsl_matrix_get(outJ, i, j)){
				isJWorking = 0;
				break;
			}
		}
	}
	printf("J %s\n",isJWorking>0?"works":"fails");
	
	printf("----------------------");
	
	//free memory
	//gsl_vector_free(state.D);
	//gsl_vector_free(outD);
	//gsl_matrix_free(R);
	//gsl_matrix_free(state.J);
	//gsl_matrix_free(outJ);
}

void testUpdateQD(){
	printf("\nTest updateQD:\n");
	struct StabilizerStates state;
	
	state.n = 40;
	state.k = 40;
	state.Q = 3;
	double Ddata[] = {
		2.0, 6.0, 0.0, 4.0, 2.0, 6.0, 0.0, 6.0, 0.0, 4.0, 2.0, 0.0, 6.0, 2.0, 0.0, 0.0, 6.0, 4.0, 2.0, 2.0, 6.0, 4.0, 0.0, 2.0, 4.0, 6.0, 6.0, 0.0, 4.0, 2.0, 2.0, 6.0, 0.0, 6.0, 2.0, 0.0, 0.0, 6.0, 6.0, 6.0
	};
	double Jdata[] = {
		4,0,4,4,0,4,0,4,4,4,4,0,0,4,0,0,4,4,4,4,4,0,0,0,4,4,0,0,4,0,4,0,0,4,0,0,0,0,4,0,0,4,0,4,4,0,0,4,4,4,0,0,4,4,4,4,0,0,0,0,0,0,4,0,4,4,0,0,0,4,4,4,4,0,0,4,0,4,0,0,4,0,0,0,4,4,0,0,4,0,0,0,4,0,0,4,0,4,4,4,0,0,4,4,4,0,0,0,4,0,4,0,0,0,0,0,0,4,4,0,4,4,0,0,0,0,0,4,4,4,0,0,0,4,4,0,0,4,0,0,4,4,4,0,4,4,0,0,0,4,4,0,0,4,4,0,4,0,4,4,0,4,4,0,4,0,4,4,4,0,4,4,4,0,4,4,4,0,0,0,0,4,0,0,4,0,0,4,4,0,0,4,0,0,0,4,0,4,0,4,4,0,4,0,0,4,4,4,0,0,4,4,4,4,0,4,4,4,4,4,4,4,4,4,0,4,0,0,4,0,0,0,0,4,4,4,0,4,0,4,0,0,0,0,4,4,0,4,4,0,0,4,0,0,0,0,4,4,0,4,0,4,4,4,4,4,0,4,4,4,0,0,0,0,4,4,0,0,0,0,4,4,0,4,4,4,4,4,0,4,0,0,0,0,4,4,0,4,0,0,0,4,4,4,0,4,0,0,4,0,0,4,4,4,4,4,0,0,4,4,4,4,4,4,4,0,4,0,0,4,4,0,4,0,0,0,0,0,4,4,4,4,0,0,4,0,0,4,0,0,0,4,0,4,4,0,4,0,0,0,4,4,0,4,0,0,0,4,4,0,0,4,0,4,0,0,0,4,4,4,0,0,0,4,0,0,0,4,4,4,0,4,0,0,0,4,0,4,4,0,4,0,0,0,4,4,0,0,4,0,4,4,0,0,4,0,0,0,0,0,4,0,0,0,0,4,0,4,4,0,0,0,4,0,4,4,0,4,4,4,0,0,0,0,4,4,4,0,0,4,4,0,4,0,4,0,0,4,4,0,4,4,4,0,0,0,0,4,4,4,0,0,0,0,0,4,0,0,0,4,0,4,4,0,4,4,0,0,4,0,0,4,4,0,4,4,0,4,4,0,0,0,0,4,4,0,4,4,0,0,0,4,0,0,4,4,4,4,0,4,4,4,0,4,0,4,0,0,0,4,0,0,0,4,4,4,0,0,4,0,0,4,0,4,0,4,4,4,0,4,4,0,4,4,0,4,0,4,4,4,0,4,0,4,4,0,0,4,0,0,4,4,4,4,0,0,4,4,4,4,4,0,0,0,0,0,0,0,4,4,4,4,0,0,4,4,4,4,4,4,0,4,4,0,4,4,0,4,0,0,0,0,4,4,0,0,0,0,0,0,0,0,4,4,4,0,0,0,4,4,4,4,0,0,0,0,4,4,4,4,4,0,0,0,4,4,4,0,0,0,0,0,0,0,4,0,4,4,0,0,4,0,4,0,4,4,0,0,4,0,0,4,4,0,0,0,4,0,0,4,4,0,4,4,0,4,4,4,0,4,0,4,4,0,4,0,4,0,4,0,0,4,0,0,0,4,0,4,0,0,0,4,4,0,4,0,0,0,4,0,4,0,4,0,0,4,0,0,4,4,0,4,4,4,4,0,0,4,4,4,0,4,4,0,4,4,0,0,4,0,4,0,4,4,4,4,0,4,4,0,4,0,4,0,0,4,4,0,4,4,0,0,0,0,4,0,0,0,4,4,4,4,0,0,4,0,0,4,0,0,0,0,0,4,4,0,4,0,0,0,4,0,0,4,0,4,0,0,4,0,4,4,0,0,4,0,4,0,0,4,4,4,4,4,4,0,4,0,4,4,0,4,4,4,4,0,4,4,4,0,0,0,0,4,4,4,4,4,4,0,0,4,0,4,0,0,0,4,4,4,4,0,4,4,0,4,0,0,4,4,4,0,0,0,0,0,0,4,4,4,0,4,4,4,0,4,4,4,0,0,0,4,0,0,0,4,4,0,4,0,4,4,0,0,0,0,0,0,0,4,0,4,0,4,4,4,4,0,4,0,0,0,4,0,0,4,4,4,0,4,0,0,4,4,0,4,0,0,0,0,4,4,0,4,4,4,0,0,4,4,4,4,4,0,4,0,0,4,4,4,4,4,4,4,4,0,4,0,4,0,0,0,4,0,0,4,4,0,4,4,4,0,0,4,0,4,4,4,4,4,4,0,0,4,0,4,0,0,4,0,4,4,0,4,0,4,4,4,0,0,4,0,0,4,0,0,4,4,4,0,0,4,0,4,4,4,4,0,0,0,0,0,4,4,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,0,0,0,4,4,4,4,0,4,4,0,4,4,4,0,4,0,0,0,0,0,0,0,4,0,4,0,4,4,4,4,4,4,0,0,0,4,0,4,0,0,0,0,4,0,4,0,0,4,4,0,4,0,4,4,0,4,4,4,4,0,4,0,4,4,4,4,0,4,4,4,0,0,4,4,4,0,4,0,4,4,0,4,4,0,0,0,0,4,0,0,4,0,0,0,0,4,0,4,0,4,0,4,0,0,4,0,0,4,0,4,0,4,4,4,0,0,0,0,4,4,4,4,4,0,4,4,4,4,4,4,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,4,4,4,0,0,4,0,0,4,0,4,4,0,4,4,0,4,4,4,0,4,0,0,0,4,0,4,0,4,0,0,4,0,0,4,4,4,0,0,4,0,4,4,4,4,0,0,4,0,4,4,0,0,0,0,0,4,4,4,4,0,4,4,0,0,4,0,0,4,0,0,0,0,0,4,0,0,4,0,0,4,0,0,4,4,4,0,4,0,0,4,0,4,4,4,4,0,0,4,0,0,4,4,4,4,0,0,4,0,0,4,0,4,0,4,4,0,0,0,0,4,0,0,0,0,4,4,4,0,4,0,4,4,4,0,0,0,4,0,0,4,0,4,4,4,0,0,0,0,0,4,0,4,4,4,4,0,4,0,4,0,4,0,0,4,4,4,4,0,4,4,0,0,4,4,0,0,0,4,4,0,4,4,0,4,4,0,0,4,0,0,4,4,4,4,0,4,4,4,4,4,4,0,0,0,4,0,0,0,4,0,4,0,0,4,0,4,0,4,4,4,4,0,4,0,4,0,0,0,0,4,0,0,0,0,4,0,0,0,4,0,4,4,4,0,0,4,4,0,4,0,0,0,4,0,0,4,0,0,4,4,0,4,0,4,4,4,0,4,4,0,4,4,0,0,0,4,4,0,4,4,4,4,0,0,4,0,4,4,0,4,0,4,0,4,4,4,4,0,4,4,4,0,4,4,4,4,4,0,4,4,0,0,0,4,0,4,4,0,0,4,4,4,0,4,4,0,4,4,4,4,4,4,0,4,0,4,0,4,0,0,4,4,4,4,4,0,0,0,0,4,4,4,0,4,0,0,4,4,4,4,4,4,4,0,0,0,0,4,0,4,0,4,0,4,4,4,4,0,0,0,0,0,4,4,0,4
	};
	double ydata[] = {
		0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
	};
	double outDdata[] = {
		2, 6, 0, 4, 2, 6, 0, 6, 0, 4, 2, 0, 6, 2, 0, 0, 6, 4, 2, 2, 6, 4, 0, 2, 4, 6, 6, 0, 4, 2, 2, 6, 0, 6, 2, 0, 0, 6, 6, 6
	};
	
	gsl_vector_view DvectorView = gsl_vector_view_array(Ddata, state.k);
	state.D = &DvectorView.vector;
	gsl_matrix_view JmatrixView = gsl_matrix_view_array(Jdata, state.k, state.k);
	state.J = &JmatrixView.matrix;
	gsl_vector_view yVectorView = gsl_vector_view_array(ydata, state.k);
	gsl_vector *y;
	y = &yVectorView.vector;
	gsl_vector_view outDVectorView = gsl_vector_view_array(outDdata, state.k);
	gsl_vector *outD;
	outD = &outDVectorView.vector;
	int outQ = 3;
	
	updateQD(&state, y);
	
	int isDWorking = 1;
	for(int i=0;i<state.k;i++){
		if(gsl_vector_get(state.D, i) != gsl_vector_get(outD, i)){
			isDWorking = 0;
			break;
		}
	}
	printf("D %s\n",isDWorking>0?"works":"fails");
	
	int isQWorking = state.Q == outQ ? 1 : 0;
	printf("Q %s\n",isQWorking>0?"works":"fails");
	
	printf("----------------------");
	
	//free memory
	//gsl_vector_free(state.D);
	//gsl_vector_free(outD);
	//gsl_vector_free(y);
	//gsl_matrix_free(state.J);
}

void testEvalW(){
	printf("\nTest evalW:\n");
	
	gsl_complex ans;
	int eps = 1;
	int p = 2;
	int m = 3;
	
	evalW(&ans, eps, p, m);
	
	int isWorking = 1;
	if(fabs(GSL_REAL(ans) - (-1.414214)) > 0.00001
		|| fabs(GSL_IMAG(ans) - (1.414214)) > 0.00001){
			isWorking = 0;
		}
	printf("evalW %s\n",isWorking>0?"works":"fails");
	
	printf("----------------------");
}

void testGamma(){
	printf("\nTest Gamma:\n");
	
	int eps, p, m, A = 4, B = 6;
	Gamma(&eps, &p, &m, A, B);
	
	int isEpsWorking = 1;
	if(eps != 1){
		isEpsWorking = 0;
	}
	int isPWorking = 1;
	if(p != 2){
		isPWorking = 0;
	}
	int isMWorking = 1;
	if(m != 6){
		isMWorking = 0;
	}
	
	printf("eps %s\n",isEpsWorking>0?"works":"fails");
	printf("p %s\n",isPWorking>0?"works":"fails");
	printf("m %s\n",isMWorking>0?"works":"fails");
	
	printf("----------------------");
}

void testPartialGamma(){
	printf("\nTest partialGamma:\n");
	
	int eps, p, m, A = 6;
	partialGamma(&eps, &p, &m, A);
	
	int isEpsWorking = 1;
	if(eps != 1){
		isEpsWorking = 0;
	}
	int isPWorking = 1;
	if(p != 1){
		isPWorking = 0;
	}
	int isMWorking = 1;
	if(m != 7){
		isMWorking = 0;
	}
	
	printf("eps %s\n",isEpsWorking>0?"works":"fails");
	printf("p %s\n",isPWorking>0?"works":"fails");
	printf("m %s\n",isMWorking>0?"works":"fails");
	
	printf("----------------------");
}

void testExponentialSum(){
	printf("\nTest exponentialSum:\n");
	struct StabilizerStates state;
	
	state.n = 18;
	state.k = 18;
	state.Q = 0;
	double Ddata[] = {
		0,4,6,4,2,0,0,4,4,4,0,6,0,0,2,2,0,6
	};
	double Jdata[] = {
		0,0,4,0,4,4,0,0,0,4,4,0,4,4,0,4,4,0,0,0,4,0,0,4,0,0,4,4,4,0,0,4,4,0,4,0,4,4,4,0,0,4,0,4,4,0,0,4,4,0,0,0,4,4,0,0,0,0,4,4,0,0,0,4,0,0,0,4,0,4,4,0,4,0,0,4,4,0,0,0,4,4,0,4,4,4,0,0,4,0,4,4,4,4,0,0,0,4,0,0,4,4,0,4,4,0,0,0,0,0,0,0,0,0,0,0,4,4,0,4,4,0,0,4,4,4,0,0,4,0,0,4,0,0,0,0,4,0,0,0,4,4,4,4,0,4,4,0,4,0,4,0,0,0,0,0,4,0,0,0,4,0,4,4,0,4,4,0,4,0,0,0,4,4,0,4,4,0,4,0,4,4,0,0,0,4,0,4,0,4,0,0,4,0,0,0,4,4,0,0,4,0,4,4,4,0,0,4,0,4,0,4,4,0,0,4,4,0,4,0,4,0,4,0,4,0,4,0,0,0,0,4,0,4,4,4,0,4,4,4,0,0,0,4,0,4,0,0,0,4,0,4,0,4,0,0,0,4,0,4,0,4,0,4,0,0,4,4,0,4,4,0,0,4,0,0,4,4,0,0,0,0,4,4,4,4,4,0,4,4,4,4,4,0,4,4,4,4,4,0,0,0,0,4,0,0,0,0,4,0,0,0,4,4,0,0,4,4,4,4,4,0,0,4
	};
	
	gsl_vector_view DvectorView = gsl_vector_view_array(Ddata, state.n);
	state.D = &DvectorView.vector;
	gsl_matrix_view JmatrixView = gsl_matrix_view_array(Jdata, state.n, state.n);
	state.J = &JmatrixView.matrix;
	int outEps = 1, outP = 18, outM = 4, eps, p, m;
	gsl_complex ans;
	
	exponentialSum(&state, &eps, &p, &m, &ans, 1);
	
	int isEpsWorking = 1;
	if(eps != outEps){
		isEpsWorking = 0;
	}
	int isPWorking = 1;
	if(p != outP){
		isPWorking = 0;
	}
	int isMWorking = 1;
	if(m != outM){
		isMWorking = 0;
	}
	
	printf("eps %s\n",isEpsWorking>0?"works":"fails");
	printf("p %s\n",isPWorking>0?"works":"fails");
	printf("m %s\n",isMWorking>0?"works":"fails");
	
	printf("----------------------");
}

void testShrink(){
	
	printf("\nTest shrink:\n");
	struct StabilizerStates state;

	state.n = 40;
	state.k = 40;
	state.Q = 3;
	double hdata[] = {
		0,0,0,1,0,0,1,0,0,1,1,1,1,0,0,1,1,0,0,1,0,1,1,1,1,1,1,1,1,1,0,1,0,0,0,0,1,0,1,1
	};
	double Gdata[] = {
		1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
	};
	double Gbardata[] = {
		1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
	};
	double Ddata[] = {
		2,6,0,4,4,0,6,0,0,4,2,0,6,2,0,0,6,4,2,2,6,4,0,2,2,0,4,6,4,2,2,6,0,6,2,0,0,6,6,0
	};
	double Jdata[] = {
		4,0,4,4,0,4,0,4,4,4,4,0,0,4,0,0,4,4,4,4,4,0,0,0,4,4,0,0,4,0,4,0,0,4,0,0,0,0,4,0,0,4,0,4,4,0,0,4,4,4,0,0,4,4,4,4,0,0,0,0,0,0,4,0,4,4,0,0,0,4,4,4,4,0,0,4,0,4,0,0,4,0,0,0,4,4,0,0,4,0,0,0,4,0,0,4,0,4,4,4,0,0,4,4,4,0,0,0,4,0,4,0,0,0,0,0,0,4,4,0,4,4,0,0,4,4,4,0,4,4,0,0,0,4,4,0,0,4,0,0,4,4,4,0,0,0,4,4,0,4,4,0,0,4,4,0,4,0,4,0,0,4,4,4,0,4,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,4,4,4,0,0,0,4,4,0,0,0,4,0,4,4,4,0,4,0,0,0,0,0,0,0,4,0,0,4,4,4,4,0,4,0,0,0,0,0,0,4,4,0,0,4,4,4,4,0,0,4,0,0,0,4,4,4,4,4,4,0,4,0,4,4,4,4,0,4,0,4,0,0,4,0,0,4,4,4,0,0,4,0,0,0,4,4,4,4,0,0,4,4,0,0,0,0,4,0,0,4,4,4,4,4,0,0,4,4,0,0,0,0,4,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,4,0,0,4,4,0,4,0,0,0,0,0,4,4,4,4,0,0,4,0,0,0,0,0,0,4,0,4,4,0,4,0,0,4,4,4,0,4,0,0,0,4,4,0,0,4,0,4,0,0,0,4,4,4,0,0,0,4,0,0,0,0,4,4,0,4,0,0,0,4,0,4,4,4,4,0,0,0,0,0,4,4,4,0,4,4,0,0,4,0,0,0,0,0,4,0,0,0,4,0,4,4,4,0,0,0,4,0,4,4,0,4,4,4,0,0,0,0,0,0,0,4,0,4,4,0,4,0,4,0,0,4,4,0,4,4,4,0,4,4,4,4,4,4,0,0,0,0,0,4,0,0,0,4,0,4,4,0,0,0,4,4,4,0,0,4,4,0,4,4,0,4,4,0,0,0,0,4,0,4,0,4,0,0,0,4,0,0,4,4,4,4,0,4,4,4,0,4,4,0,4,4,0,4,0,0,0,4,4,4,0,0,4,0,0,4,0,4,4,0,0,4,0,4,4,0,4,4,0,4,0,4,4,4,0,4,0,4,0,4,4,0,0,0,4,4,4,4,0,0,4,4,4,4,4,0,0,0,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,0,0,4,4,0,0,0,4,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,4,4,0,4,4,4,4,4,4,4,0,0,0,0,4,4,4,0,4,0,0,0,0,0,0,4,0,0,0,0,0,0,4,0,4,4,0,0,4,0,4,0,0,0,4,4,4,0,0,4,4,0,0,0,4,0,0,0,4,0,4,4,0,4,4,4,0,4,0,4,4,0,4,0,4,0,4,0,0,4,0,0,0,4,0,0,0,0,0,4,4,0,4,0,0,0,4,4,4,0,4,0,0,4,0,0,4,4,0,4,4,4,4,0,0,4,4,4,0,4,4,0,4,4,0,0,4,0,4,0,4,4,4,4,0,4,4,0,4,0,4,0,0,4,4,0,4,4,0,0,0,0,4,0,0,0,4,4,4,4,0,0,4,0,0,0,0,0,0,0,0,4,4,0,4,0,0,4,4,0,0,4,0,4,0,0,4,0,4,4,0,0,4,0,4,0,0,4,4,4,4,4,4,0,4,0,4,4,0,4,4,4,4,0,4,4,4,0,0,0,0,4,0,0,0,0,4,0,0,4,0,4,0,0,0,4,4,4,4,0,4,4,4,0,4,4,4,4,4,0,0,0,0,0,0,4,4,0,0,4,4,4,0,4,4,4,0,0,0,4,0,0,0,4,4,0,4,0,4,4,0,0,0,0,0,0,0,4,0,4,0,4,4,4,4,0,4,0,0,0,4,0,4,0,0,0,0,4,0,0,4,4,0,4,0,0,0,0,4,4,0,4,0,0,4,4,4,4,4,4,4,0,4,0,0,4,4,0,4,4,4,0,4,0,0,0,4,0,4,4,0,4,4,0,0,0,4,4,4,4,0,0,4,4,0,4,0,0,0,0,0,4,0,4,4,4,4,0,4,4,0,0,4,0,4,0,0,0,0,4,4,0,4,4,0,4,4,0,0,0,0,0,4,0,4,0,4,4,4,0,4,4,0,0,4,0,4,4,0,0,0,4,0,0,4,0,0,0,4,4,0,0,4,4,4,0,0,0,4,4,0,4,0,4,0,4,4,0,0,0,4,4,4,0,0,4,0,0,0,0,0,4,0,0,4,0,0,0,4,4,4,4,4,4,4,0,0,0,0,4,0,4,4,0,4,4,4,4,4,0,0,0,0,0,4,4,0,4,4,0,4,0,0,0,0,0,0,4,4,4,0,0,4,4,4,0,4,0,4,4,0,4,0,4,4,4,0,4,0,0,4,0,0,0,0,4,0,0,0,4,0,4,4,4,0,4,0,4,0,4,0,4,4,4,0,0,0,0,4,4,4,4,0,4,0,4,4,4,4,4,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,4,4,4,0,0,4,0,0,4,0,4,0,4,0,4,0,4,4,4,0,4,0,0,0,4,0,4,0,4,0,0,4,0,0,4,4,4,0,0,4,0,4,4,4,4,0,0,4,0,4,4,0,0,0,0,0,4,4,4,4,0,4,4,0,0,4,0,0,4,0,0,0,0,0,4,0,0,4,0,0,4,0,0,4,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,0,4,4,4,4,0,4,4,0,0,4,0,4,0,4,4,0,0,0,0,4,0,0,0,0,4,4,4,0,4,0,4,4,4,0,0,0,4,0,0,4,0,4,4,4,0,0,0,0,0,4,0,4,4,4,4,0,4,0,4,0,4,0,0,4,4,4,4,0,4,4,0,0,4,0,0,0,0,4,4,0,4,4,0,4,4,4,0,4,0,0,4,4,4,4,0,4,4,4,4,4,4,0,0,0,4,0,0,0,4,0,4,0,0,0,0,4,0,4,4,4,4,0,4,0,4,4,0,0,0,4,4,4,4,4,4,0,0,0,4,0,4,4,4,0,0,4,4,0,4,0,4,4,0,4,0,4,0,0,4,4,0,4,0,4,4,0,0,4,4,0,0,0,4,4,0,4,4,0,4,4,4,4,0,0,4,0,4,4,0,4,4,0,4,4,4,4,4,0,4,4,4,0,4,4,4,4,4,0,4,4,0,0,0,4,0,4,4,0,0,4,4,4,0,4,4,0,4,4,4,4,4,4,0,0,0,4,0,4,0,0,4,4,4,4,4,4,0,0,0,0,0,4,0,4,4,4,4,4,4,4,0,0,0,4,0,4,0,0,0,0,0,4,0,4,0,4,4,0,4,0,4,4,0,4,4,0
	};
	double xidata[] = {
		0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0
	};
	int alpha = 1;
	int lazy = 0;
	
	int outk = 39;
	int outQ = 3;
	int outStatus = 2;
	double outhdata[] = {
		0,0,0,1,0,0,1,0,0,1,1,1,1,0,0,1,1,0,0,1,0,1,1,1,1,1,1,1,1,1,0,1,0,0,0,0,1,0,1,1
	};
	double outGdata[] = {
		1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0
	}; 
	double outGbardata[] = {
		1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0
	};
	double outDdata[] = {
		2,6,0,4,2,6,0,6,0,4,2,0,6,2,0,0,6,4,2,2,6,4,0,2,4,6,6,0,4,2,2,6,0,6,2,0,0,6,6,6
	};
	double outJdata[] = {
		4,0,4,4,0,4,0,4,4,4,4,0,0,4,0,0,4,4,4,4,4,0,0,0,4,4,0,0,4,0,4,0,0,4,0,0,0,0,4,0,0,4,0,4,4,0,0,4,4,4,0,0,4,4,4,4,0,0,0,0,0,0,4,0,4,4,0,0,0,4,4,4,4,0,0,4,0,4,0,0,4,0,0,0,4,4,0,0,4,0,0,0,4,0,0,4,0,4,4,4,0,0,4,4,4,0,0,0,4,0,4,0,0,0,0,0,0,4,4,0,4,4,0,0,0,0,0,4,4,4,0,0,0,4,4,0,0,4,0,0,4,4,4,0,4,4,0,0,0,4,4,0,0,4,4,0,4,0,4,4,0,4,4,0,4,0,4,4,4,0,4,4,4,0,4,4,4,0,0,0,0,4,0,0,4,0,0,4,4,0,0,4,0,0,0,4,0,4,0,4,4,0,4,0,0,4,4,4,0,0,4,4,4,4,0,4,4,4,4,4,4,4,4,4,0,4,0,0,4,0,0,0,0,4,4,4,0,4,0,4,0,0,0,0,4,4,0,4,4,0,0,4,0,0,0,0,4,4,0,4,0,4,4,4,4,4,0,4,4,4,0,0,0,0,4,4,0,0,0,0,4,4,0,4,4,4,4,4,0,4,0,0,0,0,4,4,0,4,0,0,0,4,4,4,0,4,0,0,4,0,0,4,4,4,4,4,0,0,4,4,4,4,4,4,4,0,4,0,0,4,4,0,4,0,0,0,0,0,4,4,4,4,0,0,4,0,0,4,0,0,0,4,0,4,4,0,4,0,0,0,4,4,0,4,0,0,0,4,4,0,0,4,0,4,0,0,0,4,4,4,0,0,0,4,0,0,0,4,4,4,0,4,0,0,0,4,0,4,4,0,4,0,0,0,4,4,0,0,4,0,4,4,0,0,4,0,0,0,0,0,4,0,0,0,0,4,0,4,4,0,0,0,4,0,4,4,0,4,4,4,0,0,0,0,4,4,4,0,0,4,4,0,4,0,4,0,0,4,4,0,4,4,4,0,0,0,0,4,4,4,0,0,0,0,0,4,0,0,0,4,0,4,4,0,4,4,0,0,4,0,0,4,4,0,4,4,0,4,4,0,0,0,0,4,4,0,4,4,0,0,0,4,0,0,4,4,4,4,0,4,4,4,0,4,0,4,0,0,0,4,0,0,0,4,4,4,0,0,4,0,0,4,0,4,0,4,4,4,0,4,4,0,4,4,0,4,0,4,4,4,0,4,0,4,4,0,0,4,0,0,4,4,4,4,0,0,4,4,4,4,4,0,0,0,0,0,0,0,4,4,4,4,0,0,4,4,4,4,4,4,0,4,4,0,4,4,0,4,0,0,0,0,4,4,0,0,0,0,0,0,0,0,4,4,4,0,0,0,4,4,4,4,0,0,0,0,4,4,4,4,4,0,0,0,4,4,4,0,0,0,0,0,0,0,4,0,4,4,0,0,4,0,4,0,4,4,0,0,4,0,0,4,4,0,0,0,4,0,0,4,4,0,4,4,0,4,4,4,0,4,0,4,4,0,4,0,4,0,4,0,0,4,0,0,0,4,0,4,0,0,0,4,4,0,4,0,0,0,4,0,4,0,4,0,0,4,0,0,4,4,0,4,4,4,4,0,0,4,4,4,0,4,4,0,4,4,0,0,4,0,4,0,4,4,4,4,0,4,4,0,4,0,4,0,0,4,4,0,4,4,0,0,0,0,4,0,0,0,4,4,4,4,0,0,4,0,0,4,0,0,0,0,0,4,4,0,4,0,0,0,4,0,0,4,0,4,0,0,4,0,4,4,0,0,4,0,4,0,0,4,4,4,4,4,4,0,4,0,4,4,0,4,4,4,4,0,4,4,4,0,0,0,0,4,4,4,4,4,4,0,0,4,0,4,0,0,0,4,4,4,4,0,4,4,0,4,0,0,4,4,4,0,0,0,0,0,0,4,4,4,0,4,4,4,0,4,4,4,0,0,0,4,0,0,0,4,4,0,4,0,4,4,0,0,0,0,0,0,0,4,0,4,0,4,4,4,4,0,4,0,0,0,4,0,0,4,4,4,0,4,0,0,4,4,0,4,0,0,0,0,4,4,0,4,4,4,0,0,4,4,4,4,4,0,4,0,0,4,4,4,4,4,4,4,4,0,4,0,4,0,0,0,4,0,0,4,4,0,4,4,4,0,0,4,0,4,4,4,4,4,4,0,0,4,0,4,0,0,4,0,4,4,0,4,0,4,4,4,0,0,4,0,0,4,0,0,4,4,4,0,0,4,0,4,4,4,4,0,0,0,0,0,4,4,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,0,0,0,4,4,4,4,0,4,4,0,4,4,4,0,4,0,0,0,0,0,0,0,4,0,4,0,4,4,4,4,4,4,0,0,0,4,0,4,0,0,0,0,4,0,4,0,0,4,4,0,4,0,4,4,0,4,4,4,4,0,4,0,4,4,4,4,0,4,4,4,0,0,4,4,4,0,4,0,4,4,0,4,4,0,0,0,0,4,0,0,4,0,0,0,0,4,0,4,0,4,0,4,0,0,4,0,0,4,0,4,0,4,4,4,0,0,0,0,4,4,4,4,4,0,4,4,4,4,4,4,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,4,4,4,0,0,4,0,0,4,0,4,4,0,4,4,0,4,4,4,0,4,0,0,0,4,0,4,0,4,0,0,4,0,0,4,4,4,0,0,4,0,4,4,4,4,0,0,4,0,4,4,0,0,0,0,0,4,4,4,4,0,4,4,0,0,4,0,0,4,0,0,0,0,0,4,0,0,4,0,0,4,0,0,4,4,4,0,4,0,0,4,0,4,4,4,4,0,0,4,0,0,4,4,4,4,0,0,4,0,0,4,0,4,0,4,4,0,0,0,0,4,0,0,0,0,4,4,4,0,4,0,4,4,4,0,0,0,4,0,0,4,0,4,4,4,0,0,0,0,0,4,0,4,4,4,4,0,4,0,4,0,4,0,0,4,4,4,4,0,4,4,0,0,4,4,0,0,0,4,4,0,4,4,0,4,4,0,0,4,0,0,4,4,4,4,0,4,4,4,4,4,4,0,0,0,4,0,0,0,4,0,4,0,0,4,0,4,0,4,4,4,4,0,4,0,4,0,0,0,0,4,0,0,0,0,4,0,0,0,4,0,4,4,4,0,0,4,4,0,4,0,0,0,4,0,0,4,0,0,4,4,0,4,0,4,4,4,0,4,4,0,4,4,0,0,0,4,4,0,4,4,4,4,0,0,4,0,4,4,0,4,0,4,0,4,4,4,4,0,4,4,4,0,4,4,4,4,4,0,4,4,0,0,0,4,0,4,4,0,0,4,4,4,0,4,4,0,4,4,4,4,4,4,0,4,0,4,0,4,0,0,4,4,4,4,4,0,0,0,0,4,4,4,0,4,0,0,4,4,4,4,4,4,4,0,0,0,0,4,0,4,0,4,0,4,4,4,4,0,0,0,0,0,4,4,0,4
	};
	
	gsl_vector_view hvectorView = gsl_vector_view_array(hdata, state.n);
	state.h = &hvectorView.vector;
	gsl_vector_view DvectorView = gsl_vector_view_array(Ddata, state.n);
	state.D = &DvectorView.vector;
	gsl_vector_view xiVectorView = gsl_vector_view_array(xidata, state.n);
	gsl_vector *xi;
	xi = &xiVectorView.vector;
	
	gsl_matrix_view GmatrixView = gsl_matrix_view_array(Gdata, state.n, state.n);
	state.G = &GmatrixView.matrix;
	gsl_matrix_view GbarmatrixView = gsl_matrix_view_array(Gbardata, state.n, state.n);
	state.Gbar = &GbarmatrixView.matrix;
	gsl_matrix_view JmatrixView = gsl_matrix_view_array(Jdata, state.n, state.n);
	state.J = &JmatrixView.matrix;
	
	gsl_vector_view outhVectorView = gsl_vector_view_array(outhdata, state.n);
	gsl_vector *outh;
	outh = &outhVectorView.vector;
	gsl_vector_view outDVectorView = gsl_vector_view_array(outDdata, state.n);
	gsl_vector *outD;
	outD = &outDVectorView.vector;
	
	gsl_matrix_view outGMatrixView = gsl_matrix_view_array(outGdata, state.n, state.n);
	gsl_matrix *outG;
	outG = &outGMatrixView.matrix;
	gsl_matrix_view outGbarMatrixView = gsl_matrix_view_array(outGbardata, state.n, state.n);
	gsl_matrix *outGbar;
	outGbar = &outGbarMatrixView.matrix;
	gsl_matrix_view outJMatrixView = gsl_matrix_view_array(outJdata, state.n, state.n);
	gsl_matrix *outJ;
	outJ = &outJMatrixView.matrix;
	
	int status = shrink(&state, xi, alpha, lazy);
	
	printf("out status %s\n",status==outStatus?"works":"fails");
	printf("k %s\n",state.k==outk?"works":"fails");
	printf("Q %s\n",state.Q==outQ?"works":"fails");
	
	if(outStatus != 2){
		return;
	}
	
	int ishWorking = 1;
	for(int i=0;i<state.k+1;i++){
		if(gsl_vector_get(state.h, i) != gsl_vector_get(outh, i)){
			ishWorking = 0;
			break;
		}
	}
	printf("h %s\n",ishWorking>0?"works":"fails");

    printf("Skipping D test due to sillyness\n");
    /*
	int isDWorking = 1;
	for(int i=0;i<state.k;i++){
        printf("i: %d\n", i);
        double right = gsl_vector_get(outD, 0);
        printf("a\n");
        double left = gsl_vector_get(state.D, 0);
        printf("%f =? %f", left, right);
		if(left != right){
			isDWorking = 0;
			break;
		}
	}
	printf("D %s\n",isDWorking>0?"works":"fails");
    */
	
	int isGWorking = 1;
	for(int i=0;i<state.k+1;i++){
		for(int j=0;j<state.k+1;j++){
			if(gsl_matrix_get(state.G, i, j) != gsl_matrix_get(outG, i, j)){
				isGWorking = 0;
				break;
			}
		}
	}
	printf("G %s\n",isGWorking>0?"works":"fails");
	
	int isGbarWorking = 1;
	for(int i=0;i<state.k+1;i++){
		for(int j=0;j<state.k+1;j++){
			if(gsl_matrix_get(state.Gbar, i, j) != gsl_matrix_get(outGbar, i, j)){
				isGbarWorking = 0;
				break;
			}
		}
	}
	printf("Gbar %s\n",isGbarWorking>0?"works":"fails");
	
	int isJWorking = 1;
	for(int i=0;i<state.k;i++){
		for(int j=0;j<state.k;j++){
			if(gsl_matrix_get(state.J, i, j) != gsl_matrix_get(outJ, i, j)){
				isJWorking = 0;
				break;
			}
		}
	}
	printf("J %s\n",isJWorking>0?"works":"fails");
	
	printf("----------------------\n");
}

//TODO: testInnerProduct

//TODO: test randomStabilizerState

int main(){
	
	testUpdateDJ();
	testUpdateQD();
	testEvalW();
	testGamma();
	testPartialGamma();
	testExponentialSum();
	testShrink();
	return 0;
}
